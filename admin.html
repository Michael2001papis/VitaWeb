<!doctype html>
<html lang="he" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>פאנל ניהול – הנדימן בערד, מיתר ובאר שבע</title>
  <style>
    :root { 
      --brand: #2563eb; 
      --brand-2: #1d4ed8; 
      --brand-3: #3b82f6;
      --brand-light: #dbeafe;
      --danger: #dc2626; 
      --ok: #059669;
      --warning: #d97706;
      --gray-50: #f8fafc;
      --gray-100: #f1f5f9;
      --gray-200: #e2e8f0;
      --gray-300: #cbd5e1;
      --gray-400: #94a3b8;
      --gray-500: #64748b;
      --gray-600: #475569;
      --gray-700: #334155;
      --gray-800: #1e293b;
      --gray-900: #0f172a;
      --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
      --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
      --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
      --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
      --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
    }
    
    * { box-sizing: border-box; }
    
    body { 
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; 
      background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 50%, #bae6fd 100%);
      color: #1e293b; 
      margin: 0; 
      line-height: 1.7;
      min-height: 100vh;
    }
    
    .container { 
      max-width: 1200px; 
      margin: 0 auto; 
      padding: 0 1rem; 
    }
    .card { 
      background: rgba(255,255,255,0.95); 
      border: 1px solid rgba(30, 64, 175, 0.1); 
      border-radius: 1.25rem; 
      padding: 2.5rem; 
      margin-bottom: 2rem; 
      backdrop-filter: blur(10px);
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      transition: all 0.3s ease;
    }
    
    .card:hover {
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      transform: translateY(-2px);
    }
    .btn { display:inline-block; padding:.7rem 1.1rem; border-radius:.6rem; text-decoration:none; border:none; cursor:pointer }
    .btn-primary { background:var(--brand); color:#fff }
    .btn-danger { background:var(--danger); color:#fff }
    .btn-ghost { background:#fff; color:#0f172a; border:1px solid #cbd5e1 }
    .hidden { display:none }
    .login-form { max-width:400px; margin:2rem auto; text-align:center }
    .dashboard { display:grid; gap:1rem }
    .stats { display:grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap:1rem }
    .stat-card { background:linear-gradient(135deg, #eef6ff, #f0f9ff); border:2px solid var(--brand); text-align:center; padding:1.5rem }
    .stat-number { font-size:2rem; font-weight:800; color:var(--brand); margin:.5rem 0 }
    .leads-table { width:100%; border-collapse:collapse; margin-top:1rem }
    .leads-table th, .leads-table td { padding:.5rem; border:1px solid #e2e8f0; text-align:right }
    .leads-table th { background:#f8fafc; font-weight:600 }
    .status-new { background:#fef3c7; color:#92400e; padding:.2rem .5rem; border-radius:.3rem; font-size:.8rem }
    .status-contacted { background:#dbeafe; color:#1e40af; padding:.2rem .5rem; border-radius:.3rem; font-size:.8rem }
    .status-quoted { background:#d1fae5; color:#065f46; padding:.2rem .5rem; border-radius:.3rem; font-size:.8rem }
    input, textarea, select { width:100%; padding:.6rem; border:1px solid #cbd5e1; border-radius:.4rem; font-family:inherit; margin:.5rem 0 }
    input:focus, textarea:focus, select:focus { outline:3px solid var(--brand); outline-offset:2px }
    .grid { display:grid; gap:1rem }
    .grid-2 { grid-template-columns: repeat(2, minmax(0,1fr)) }
    .grid-3 { grid-template-columns: repeat(3, minmax(0,1fr)) }
    .grid-4 { grid-template-columns: repeat(4, minmax(0,1fr)) }
    @media (max-width: 720px){ .grid-2,.grid-3,.grid-4{ grid-template-columns: 1fr } }
    .stats-card { text-align:center; padding:1.5rem; background:linear-gradient(135deg, #eef6ff, #f0f9ff); border:1px solid var(--brand); border-radius:.8rem }
    .stats-number { font-size:2.5rem; font-weight:800; color:var(--brand); margin:.5rem 0 }
    .stats-label { color:#374151; font-size:.9rem; margin:0; font-weight:500 }
    .lead-item { border:1px solid #e2e8f0; border-radius:.6rem; padding:1rem; margin-bottom:.8rem; background:#fff }
    .lead-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:.5rem }
    .lead-name { font-weight:600; color:var(--brand) }
    .lead-date { color:#64748b; font-size:.85rem }
    .lead-details { color:#374151; font-size:.9rem; line-height:1.4; font-weight:500 }
    .status-badge { padding:.3rem .6rem; border-radius:999px; font-size:.8rem; font-weight:600 }
    .status-new { background:#dbeafe; color:#1e40af }
    .status-contacted { background:#dcfce7; color:#166534 }
    .status-quoted { background:#fef3c7; color:#92400e }
    .status-won { background:#dcfce7; color:#166534 }
    .status-lost { background:#fee2e2; color:#dc2626 }
    .action-buttons { display:flex; gap:.5rem; margin-top:.8rem }
    .action-buttons .btn { padding:.4rem .8rem; font-size:.85rem }
    .filter-tabs { display:flex; gap:.5rem; margin-bottom:1rem; border-bottom:1px solid #e2e8f0 }
    .filter-tab { padding:.6rem 1rem; background:none; border:none; cursor:pointer; color:#374151; border-bottom:2px solid transparent; font-weight:500 }
    .filter-tab.active { color:var(--brand); border-bottom-color:var(--brand) }
    .search-box { width:100%; padding:.6rem; border:1px solid #cbd5e1; border-radius:.4rem; margin-bottom:1rem }
    .modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,.5); z-index:1000 }
    .modal-content { position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); background:#fff; border-radius:.8rem; padding:2rem; max-width:500px; width:90% }
    .modal-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:1rem }
    .close-btn { background:none; border:none; font-size:1.5rem; cursor:pointer; color:#64748b }
    .form-group { margin-bottom:1rem }
    .form-group label { display:block; margin-bottom:.3rem; font-weight:600; color:#374151 }
    .form-group input, .form-group select, .form-group textarea { width:100%; padding:.6rem; border:1px solid #cbd5e1; border-radius:.4rem; font-family:inherit }
    .form-group textarea { height:80px; resize:vertical }
    .tabs { display:flex; gap:.5rem; margin-bottom:1rem; border-bottom:1px solid #e2e8f0 }
    .tab { padding:.6rem 1rem; background:none; border:none; cursor:pointer; color:#374151; border-bottom:2px solid transparent; font-weight:500 }
    .tab.active { color:var(--brand); border-bottom-color:var(--brand) }
    .tab-content { display:none }
    .tab-content.active { display:block }
    .log-item { border:1px solid #e2e8f0; border-radius:.4rem; padding:.8rem; margin-bottom:.5rem; background:#f8fafc }
    .log-time { font-size:.8rem; color:#64748b; margin-bottom:.2rem }
    .log-action { font-weight:600; color:#374151; margin-bottom:.2rem }
    .log-details { font-size:.85rem; color:#374151; font-weight:500 }
  </style>
</head>
<body>
  <div class="container">
    <!-- מסך כניסה -->
    <div id="loginScreen" class="login-form">
      <div class="card">
        <h1 style="margin:0 0 1rem 0; color:var(--brand);">פאנל מנהל VitaWeb</h1>
        <form id="loginForm">
          <div>
            <label for="username" style="display:block; text-align:right; margin-bottom:.2rem;">שם משתמש</label>
            <input id="username" name="username" type="text" required>
          </div>
          <div>
            <label for="password" style="display:block; text-align:right; margin-bottom:.2rem;">סיסמה</label>
            <input id="password" name="password" type="password" required>
          </div>
          <button type="submit" class="btn btn-primary" style="margin-top:1rem;">התחבר</button>
        </form>
        <p id="loginError" style="color:var(--danger); margin:1rem 0 0 0; display:none;">שם משתמש או סיסמה שגויים</p>
      </div>
    </div>

    <!-- דשבורד מנהל -->
    <div id="dashboard" class="hidden">
      <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:2rem;">
        <h1 style="margin:0; color:var(--brand);">פאנל ניהול - הנדימן בערד, מיתר ובאר שבע</h1>
        <button id="logoutBtn" class="btn btn-danger">התנתק</button>
      </div>

      <!-- סטטיסטיקות מתקדמות -->
      <div class="grid grid-4">
        <div class="stats-card">
          <div class="stats-number" id="totalLeads">0</div>
          <div class="stats-label">סה"כ לידים</div>
        </div>
        <div class="stats-card">
          <div class="stats-number" id="newLeads">0</div>
          <div class="stats-label">לידים חדשים</div>
        </div>
        <div class="stats-card">
          <div class="stats-number" id="contactedLeads">0</div>
          <div class="stats-label">לידים שטופלו</div>
        </div>
        <div class="stats-card">
          <div class="stats-number" id="quotedLeads">0</div>
          <div class="stats-label">הצעות מחיר</div>
        </div>
      </div>

      <!-- טאבים -->
      <div class="tabs">
        <button class="tab active" onclick="switchTab('leads')">לידים</button>
        <button class="tab" onclick="switchTab('quotes')">הצעות מחיר</button>
        <button class="tab" onclick="switchTab('projects')">פרויקטים</button>
        <button class="tab" onclick="switchTab('content')">ניהול תוכן</button>
        <button class="tab" onclick="switchTab('settings')">הגדרות</button>
        <button class="tab" onclick="switchTab('analytics')">סטטיסטיקות</button>
        <button class="tab" onclick="switchTab('logs')">לוגים</button>
      </div>

      <!-- תוכן טאבים -->
      <div id="leads-tab" class="tab-content active">
        <div class="card">
          <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:1rem;">
            <h2>ניהול לידים</h2>
            <input type="text" class="search-box" placeholder="חיפוש לידים..." id="searchLeads">
          </div>
          
          <!-- פילטרים -->
          <div class="filter-tabs">
            <button class="filter-tab active" onclick="filterLeads('all')">הכל</button>
            <button class="filter-tab" onclick="filterLeads('new')">חדשים</button>
            <button class="filter-tab" onclick="filterLeads('contacted')">טופלו</button>
            <button class="filter-tab" onclick="filterLeads('quoted')">הוצע מחיר</button>
            <button class="filter-tab" onclick="filterLeads('won')">נסגרו</button>
          </div>

          <div id="leadsList">
            <!-- לידים יוצגו כאן -->
          </div>
        </div>
      </div>

      <div id="quotes-tab" class="tab-content">
        <div class="card">
          <h2>הצעות מחיר</h2>
          <div id="quotesList">
            <p>אין הצעות מחיר עדיין</p>
          </div>
        </div>
      </div>

      <div id="projects-tab" class="tab-content">
        <div class="card">
          <h2>פרויקטים פעילים</h2>
          <div id="projectsList">
            <p>אין פרויקטים פעילים</p>
          </div>
        </div>
      </div>

      <div id="content-tab" class="tab-content">
        <div class="card">
          <h2>ניהול תוכן האתר</h2>
          <div class="grid grid-2">
            <div>
              <h3>עמוד הבית</h3>
              <div class="form-group">
                <label>כותרת ראשית</label>
                <input type="text" id="homeTitle" value="הנדימן בערד, מיתר ובאר שבע – תיקון אמין ומהיר">
              </div>
              <div class="form-group">
                <label>תיאור קצר</label>
                <textarea id="homeDesc" rows="3">תיקונים קטנים בלי כאב ראש: אינסטלציה קלה, חשמל, נגרות ותליית מסכים. מגיע בזמן, עובד נקי, ומתחייב לתוצאה.</textarea>
              </div>
              <button class="btn btn-primary" onclick="updateHomeContent()">עדכן</button>
            </div>
            <div>
              <h3>פרטי יצירת קשר</h3>
              <div class="form-group">
                <label>טלפון</label>
                <input type="tel" id="contactPhone" value="0508535941">
              </div>
              <div class="form-group">
                <label>אימייל</label>
                <input type="email" id="contactEmail" value="dvnka2@gmail.com">
              </div>
              <div class="form-group">
                <label>אזורי שירות</label>
                <input type="text" id="serviceAreas" value="ערד, מיתר, באר שבע">
              </div>
              <button class="btn btn-primary" onclick="updateContactInfo()">עדכן</button>
            </div>
          </div>
        </div>
      </div>

      <div id="settings-tab" class="tab-content">
        <div class="card">
          <h2>הגדרות מערכת</h2>
          <div class="grid grid-2">
            <div>
              <h3>הגדרות כללי</h3>
              <div class="form-group">
                <label>שם האתר</label>
                <input type="text" id="siteName" value="VitaWeb">
              </div>
              <div class="form-group">
                <label>כותרת SEO</label>
                <input type="text" id="seoTitle" value="הנדימן בערד, מיתר ובאר שבע">
              </div>
              <div class="form-group">
                <label>תיאור SEO</label>
                <textarea id="seoDesc" rows="3">הנדימן בערד, מיתר ובאר שבע – תיקונים קטנים, אמינים ומהירים</textarea>
              </div>
            </div>
            <div>
              <h3>הגדרות אבטחה</h3>
              <div class="form-group">
                <label>שם משתמש מנהל</label>
                <input type="text" id="adminUser" value="מיכאל" readonly>
              </div>
              <div class="form-group">
                <label>סיסמה חדשה</label>
                <input type="password" id="newPassword" placeholder="הזן סיסמה חדשה">
              </div>
              <div class="form-group">
                <label>אישור סיסמה</label>
                <input type="password" id="confirmPassword" placeholder="אשר סיסמה">
              </div>
              <button class="btn btn-primary" onclick="updatePassword()">עדכן סיסמה</button>
            </div>
          </div>
        </div>
      </div>

      <div id="analytics-tab" class="tab-content">
        <div class="card">
          <h2>סטטיסטיקות מתקדמות</h2>
          <div class="grid grid-2">
            <div>
              <h3>לידים לפי חודש</h3>
              <div id="monthlyChart">גרף יוצג כאן</div>
            </div>
            <div>
              <h3>המרות</h3>
              <div id="conversionChart">גרף יוצג כאן</div>
            </div>
          </div>
        </div>
      </div>

      <div id="logs-tab" class="tab-content">
        <div class="card">
          <h2>לוגים ופעילות</h2>
          <div class="form-group">
            <label>חיפוש לוגים</label>
            <input type="text" id="logSearch" placeholder="חפש בפעילות...">
          </div>
          <div id="logsList">
            <div class="log-item">
              <div class="log-time">2024-01-15 14:30:25</div>
              <div class="log-action">משתמש התחבר: מיכאל</div>
              <div class="log-details">IP: 192.168.1.1</div>
            </div>
            <div class="log-item">
              <div class="log-time">2024-01-15 14:25:10</div>
              <div class="log-action">ליד חדש נוסף: יוסי כהן</div>
              <div class="log-details">טלפון: 050-1234567</div>
            </div>
            <div class="log-item">
              <div class="log-time">2024-01-15 14:20:05</div>
              <div class="log-action">עדכון הגדרות אתר</div>
              <div class="log-details">שינוי כותרת עמוד הבית</div>
            </div>
          </div>
        </div>
      </div>

      <!-- הוספת ליד -->
      <div id="addLeadForm" class="card hidden">
        <h2 style="margin:0 0 1rem 0;">הוספת ליד חדש</h2>
        <form id="newLeadForm">
          <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap:1rem;">
            <div>
              <label for="newName">שם מלא</label>
              <input id="newName" name="name" type="text" required>
            </div>
            <div>
              <label for="newPhone">טלפון</label>
              <input id="newPhone" name="phone" type="tel" required>
            </div>
            <div>
              <label for="newCity">עיר</label>
              <input id="newCity" name="city" type="text" required>
            </div>
            <div>
              <label for="newService">שירות</label>
              <select id="newService" name="service">
                <option value="">בחר שירות</option>
                <option>אינסטלציה</option>
                <option>חשמל</option>
                <option>נגרות</option>
                <option>תליית טלוויזיה</option>
                <option>אחר</option>
              </select>
            </div>
            <div>
              <label for="newStatus">סטטוס</label>
              <select id="newStatus" name="status">
                <option value="new">חדש</option>
                <option value="contacted">טופל</option>
                <option value="quoted">הוצעה</option>
                <option value="won">נסגר</option>
                <option value="lost">אבוד</option>
              </select>
            </div>
          </div>
          <div>
            <label for="newDescription">תיאור</label>
            <textarea id="newDescription" name="description" rows="3"></textarea>
          </div>
          <div style="margin-top:1rem;">
            <button type="submit" class="btn btn-primary">שמור ליד</button>
            <button type="button" id="cancelAddBtn" class="btn btn-ghost">ביטול</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <script>
    // נתונים מקומיים (במקום מסד נתונים)
    let leads = JSON.parse(localStorage.getItem('vitaweb_leads') || '[]');
    let currentUser = null;

    // פונקציות עזר
    function saveLeads() {
      localStorage.setItem('vitaweb_leads', JSON.stringify(leads));
      updateStats();
    }

    function updateStats() {
      const total = leads.length;
      const newLeads = leads.filter(l => l.status === 'new').length;
      const contacted = leads.filter(l => l.status === 'contacted').length;
      const quoted = leads.filter(l => l.status === 'quoted').length;

      document.getElementById('totalLeads').textContent = total;
      document.getElementById('newLeads').textContent = newLeads;
      document.getElementById('contactedLeads').textContent = contacted;
      document.getElementById('quotedLeads').textContent = quoted;
    }

    function renderLeadsTable() {
      const tbody = document.getElementById('leadsTableBody');
      tbody.innerHTML = leads.map(lead => `
        <tr>
          <td>${new Date(lead.date).toLocaleDateString('he-IL')}</td>
          <td>${lead.name}</td>
          <td><a href="tel:${lead.phone}">${lead.phone}</a></td>
          <td>${lead.city}</td>
          <td>${lead.service || '-'}</td>
          <td><span class="status-${lead.status}">${getStatusText(lead.status)}</span></td>
          <td>
            <button onclick="editLead(${lead.id})" class="btn btn-ghost" style="padding:.3rem .6rem; font-size:.8rem;">ערוך</button>
            <button onclick="deleteLead(${lead.id})" class="btn btn-danger" style="padding:.3rem .6rem; font-size:.8rem;">מחק</button>
          </td>
        </tr>
      `).join('');
    }

    function getStatusText(status) {
      const statuses = {
        'new': 'חדש',
        'contacted': 'טופל',
        'quoted': 'הוצעה',
        'won': 'נסגר',
        'lost': 'אבוד'
      };
      return statuses[status] || status;
    }

    // פונקציות מתקדמות
    function switchTab(tabName) {
      // הסר active מכל הטאבים
      document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
      document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
      
      // הוסף active לטאב הנבחר
      event.target.classList.add('active');
      document.getElementById(tabName + '-tab').classList.add('active');
      
      // טען תוכן לפי הטאב
      if (tabName === 'leads') {
        renderLeadsList();
      } else if (tabName === 'quotes') {
        renderQuotesList();
      } else if (tabName === 'projects') {
        renderProjectsList();
      } else if (tabName === 'analytics') {
        renderAnalytics();
      }
    }

    function renderLeadsList() {
      const container = document.getElementById('leadsList');
      if (leads.length === 0) {
        container.innerHTML = '<p>אין לידים עדיין</p>';
        return;
      }

      container.innerHTML = leads.map(lead => `
        <div class="lead-item">
          <div class="lead-header">
            <div class="lead-name">${lead.name}</div>
            <div class="lead-date">${new Date(lead.date).toLocaleDateString('he-IL')}</div>
          </div>
          <div class="lead-details">
            <div><strong>טלפון:</strong> <a href="tel:${lead.phone}">${lead.phone}</a></div>
            <div><strong>עיר:</strong> ${lead.city}</div>
            <div><strong>שירות:</strong> ${lead.service || '-'}</div>
            <div><strong>תיאור:</strong> ${lead.description || '-'}</div>
          </div>
          <div class="action-buttons">
            <button class="btn btn-primary" onclick="updateLeadStatus(${lead.id}, 'contacted')">טופל</button>
            <button class="btn btn-ghost" onclick="updateLeadStatus(${lead.id}, 'quoted')">הצעת מחיר</button>
            <button class="btn btn-ghost" onclick="updateLeadStatus(${lead.id}, 'won')">נסגר</button>
            <button class="btn btn-danger" onclick="deleteLead(${lead.id})">מחק</button>
          </div>
        </div>
      `).join('');
    }

    function filterLeads(status) {
      // הסר active מכל הפילטרים
      document.querySelectorAll('.filter-tab').forEach(tab => tab.classList.remove('active'));
      // הוסף active לפילטר הנבחר
      event.target.classList.add('active');
      
      // סנן לידים
      let filteredLeads = leads;
      if (status !== 'all') {
        filteredLeads = leads.filter(lead => lead.status === status);
      }
      
      // הצג לידים מסוננים
      const container = document.getElementById('leadsList');
      if (filteredLeads.length === 0) {
        container.innerHTML = '<p>אין לידים עם הפילטר הנבחר</p>';
        return;
      }

      container.innerHTML = filteredLeads.map(lead => `
        <div class="lead-item">
          <div class="lead-header">
            <div class="lead-name">${lead.name}</div>
            <div class="lead-date">${new Date(lead.date).toLocaleDateString('he-IL')}</div>
          </div>
          <div class="lead-details">
            <div><strong>טלפון:</strong> <a href="tel:${lead.phone}">${lead.phone}</a></div>
            <div><strong>עיר:</strong> ${lead.city}</div>
            <div><strong>שירות:</strong> ${lead.service || '-'}</div>
            <div><strong>תיאור:</strong> ${lead.description || '-'}</div>
          </div>
          <div class="action-buttons">
            <button class="btn btn-primary" onclick="updateLeadStatus(${lead.id}, 'contacted')">טופל</button>
            <button class="btn btn-ghost" onclick="updateLeadStatus(${lead.id}, 'quoted')">הצעת מחיר</button>
            <button class="btn btn-ghost" onclick="updateLeadStatus(${lead.id}, 'won')">נסגר</button>
            <button class="btn btn-danger" onclick="deleteLead(${lead.id})">מחק</button>
          </div>
        </div>
      `).join('');
    }

    function updateLeadStatus(id, newStatus) {
      const lead = leads.find(l => l.id === id);
      if (lead) {
        lead.status = newStatus;
        saveLeads();
        updateStats();
        renderLeadsList();
      }
    }

    function renderQuotesList() {
      const container = document.getElementById('quotesList');
      container.innerHTML = '<p>אין הצעות מחיר עדיין. זה יוצג בעתיד.</p>';
    }

    function renderProjectsList() {
      const container = document.getElementById('projectsList');
      container.innerHTML = '<p>אין פרויקטים פעילים עדיין. זה יוצג בעתיד.</p>';
    }

    function renderAnalytics() {
      const monthlyChart = document.getElementById('monthlyChart');
      const conversionChart = document.getElementById('conversionChart');
      
      monthlyChart.innerHTML = '<p>גרף לידים לפי חודש יוצג כאן</p>';
      conversionChart.innerHTML = '<p>גרף המרות יוצג כאן</p>';
    }

    function showAddLeadModal() {
      // פותח מודל להוספת ליד חדש
      alert('מודל להוספת ליד חדש יוצג כאן');
    }

    // פונקציות ניהול תוכן
    function updateHomeContent() {
      const title = document.getElementById('homeTitle').value;
      const desc = document.getElementById('homeDesc').value;
      
      // כאן תהיה שליחה לשרת
      alert('תוכן עמוד הבית עודכן בהצלחה!');
      logActivity('עדכון תוכן עמוד הבית', `כותרת: ${title}`);
    }

    function updateContactInfo() {
      const phone = document.getElementById('contactPhone').value;
      const email = document.getElementById('contactEmail').value;
      const areas = document.getElementById('serviceAreas').value;
      
      // כאן תהיה שליחה לשרת
      alert('פרטי יצירת קשר עודכנו בהצלחה!');
      logActivity('עדכון פרטי יצירת קשר', `טלפון: ${phone}, אימייל: ${email}`);
    }

    function updatePassword() {
      const newPass = document.getElementById('newPassword').value;
      const confirmPass = document.getElementById('confirmPassword').value;
      
      if (newPass !== confirmPass) {
        alert('הסיסמאות לא תואמות');
        return;
      }
      
      if (newPass.length < 6) {
        alert('הסיסמה חייבת להיות לפחות 6 תווים');
        return;
      }
      
      // כאן תהיה שליחה לשרת
      alert('הסיסמה עודכנה בהצלחה!');
      logActivity('עדכון סיסמת מנהל', 'סיסמה שונתה');
      
      // נקה שדות
      document.getElementById('newPassword').value = '';
      document.getElementById('confirmPassword').value = '';
    }

    function logActivity(action, details) {
      const now = new Date();
      const timeStr = now.toLocaleString('he-IL');
      
      const logItem = document.createElement('div');
      logItem.className = 'log-item';
      logItem.innerHTML = `
        <div class="log-time">${timeStr}</div>
        <div class="log-action">${action}</div>
        <div class="log-details">${details}</div>
      `;
      
      const logsList = document.getElementById('logsList');
      logsList.insertBefore(logItem, logsList.firstChild);
    }

    // עדכון פונקציית switchTab
    function switchTab(tabName) {
      // הסר active מכל הטאבים
      document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
      document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
      
      // הוסף active לטאב הנבחר
      event.target.classList.add('active');
      document.getElementById(tabName + '-tab').classList.add('active');
      
      // טען תוכן לפי הטאב
      if (tabName === 'leads') {
        renderLeadsList();
      } else if (tabName === 'quotes') {
        renderQuotesList();
      } else if (tabName === 'projects') {
        renderProjectsList();
      } else if (tabName === 'analytics') {
        renderAnalytics();
      } else if (tabName === 'logs') {
        // לוגים כבר נטענים
      }
    }

    function editLead(id) {
      const lead = leads.find(l => l.id === id);
      if (!lead) return;
      
      // פותח את הטופס עם הנתונים
      document.getElementById('addLeadForm').classList.remove('hidden');
      document.getElementById('newName').value = lead.name;
      document.getElementById('newPhone').value = lead.phone;
      document.getElementById('newCity').value = lead.city;
      document.getElementById('newService').value = lead.service || '';
      document.getElementById('newStatus').value = lead.status;
      document.getElementById('newDescription').value = lead.description || '';
      
      // שומר את ה-ID לעריכה
      document.getElementById('newLeadForm').dataset.editId = id;
    }

    function deleteLead(id) {
      if (confirm('האם למחוק את הליד?')) {
        leads = leads.filter(l => l.id !== id);
        saveLeads();
        renderLeadsTable();
      }
    }

    // אירועי כניסה
    document.getElementById('loginForm').addEventListener('submit', (e) => {
      e.preventDefault();
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;
      
      if (username === 'מיכאל' && password === 'MP123456') {
        currentUser = { username, password };
        document.getElementById('loginScreen').classList.add('hidden');
        document.getElementById('dashboard').classList.remove('hidden');
        updateStats();
        renderLeadsTable();
      } else {
        document.getElementById('loginError').style.display = 'block';
      }
    });

    // אירועי דשבורד
    document.getElementById('logoutBtn').addEventListener('click', () => {
      currentUser = null;
      document.getElementById('loginScreen').classList.remove('hidden');
      document.getElementById('dashboard').classList.add('hidden');
      document.getElementById('loginForm').reset();
      document.getElementById('loginError').style.display = 'none';
    });

    document.getElementById('addLeadBtn').addEventListener('click', () => {
      document.getElementById('addLeadForm').classList.remove('hidden');
      document.getElementById('newLeadForm').reset();
      delete document.getElementById('newLeadForm').dataset.editId;
    });

    document.getElementById('cancelAddBtn').addEventListener('click', () => {
      document.getElementById('addLeadForm').classList.add('hidden');
    });

    document.getElementById('refreshBtn').addEventListener('click', () => {
      renderLeadsTable();
      updateStats();
    });

    document.getElementById('newLeadForm').addEventListener('submit', (e) => {
      e.preventDefault();
      const formData = new FormData(e.target);
      const editId = e.target.dataset.editId;
      
      const leadData = {
        name: formData.get('name'),
        phone: formData.get('phone'),
        city: formData.get('city'),
        service: formData.get('service'),
        status: formData.get('status'),
        description: formData.get('description'),
        date: new Date().toISOString()
      };

      if (editId) {
        // עריכה
        const index = leads.findIndex(l => l.id == editId);
        if (index !== -1) {
          leads[index] = { ...leads[index], ...leadData };
        }
      } else {
        // הוספה
        leadData.id = Date.now();
        leads.push(leadData);
      }

      saveLeads();
      renderLeadsList();
      document.getElementById('addLeadForm').classList.add('hidden');
      e.target.reset();
    });

    // טעינה ראשונית
    loadLeads();
    updateStats();
    renderLeadsList();
  </script>
  <button id="creditsBtn" class="btn btn-ghost" style="position:fixed; right:1rem; bottom:1rem;">זכויות יוצרים</button>
  <div id="creditsModal" style="position:fixed; inset:0; background:#0008; display:none; align-items:center; justify-content:center; z-index:50">
    <div style="background:#fff; border-radius:.8rem; padding:1rem; max-width:520px; width:90%; box-shadow:0 10px 30px #0003" role="dialog" aria-modal="true" aria-labelledby="creditsTitle">
      <h3 id="creditsTitle" style="margin:0 0 .5rem 0; color:var(--brand);">זכויות יוצרים</h3>
      <p style="margin:.2rem 0"><strong>הנדימן:</strong> VitaWeb – 050-853-5941</p>
      <p style="margin:.2rem 0"><strong>מפתח האתר:</strong> מיכאל פפיסמדוב (חתימה: Mpb)</p>
      <div style="text-align:left; margin-top:1rem;">
        <button id="closeCredits" class="btn btn-primary">סגור</button>
      </div>
    </div>
  </div>
  <script>
    (function(){
      const btn = document.getElementById('creditsBtn');
      const modal = document.getElementById('creditsModal');
      const closeBtn = document.getElementById('closeCredits');
      if(btn && modal && closeBtn){
        btn.addEventListener('click', ()=>{ modal.style.display='flex'; });
        closeBtn.addEventListener('click', ()=>{ modal.style.display='none'; });
        modal.addEventListener('click', (e)=>{ if(e.target===modal) modal.style.display='none'; });
      }
    })();
  </script>
</body>
</html>
